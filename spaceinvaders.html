<html>
  <head>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
  </head>
  <body>
    <script>
      AFRAME.registerComponent('change-alien-position', {
      tick: function() {

        var scene = document.querySelector('a-scene');
        var aliens=scene.querySelectorAll('#alien');

        for(var i=0; i<aliens.length; i++) {
          var pos = aliens[i].getAttribute('position');
          aliens[i].setAttribute('position',{x: pos.x + 0.005, y: pos.y, z: pos.z});
          if (pos.x>1.25){
            pos.x=-0.75;
            pos.y=pos.y-0.35;
          }
        }
      }
    });
    </script>
    <script>
      AFRAME.registerComponent('camera-rotation',{
      tick: function() {
        var scene = document.querySelector('a-scene');
        var shipEl=scene.querySelector('#ship');
        var fireButtonEl=scene.querySelector('#fireButton');

        var pos=shipEl.getAttribute('position');
        if (-this.el.object3D.rotation.y*1.4>-0.75 && -this.el.object3D.rotation.y*1.4<1.5)
        {
          shipEl.setAttribute('position',{x: -this.el.object3D.rotation.y*1.4, y: pos.y, z: pos.z});
          fireButtonEl.setAttribute('position',{x: -this.el.object3D.rotation.y*1.4-0.26, y: pos.y+0.25, z: pos.z-0.25});
        }

      }
    });
    </script>

    <a-scene change-alien-position>
      <a-assets>
        <a-asset-item id="alienModel" src="obj/alien.obj"></a-asset-item>
        <a-asset-item id="shipModel" src="obj/ship.obj"></a-asset-item>
      </a-assets>

      <a-sky color="black"></a-sky>

      <a-camera position="0 1.75 0" camera-rotation>
        <a-entity cursor="fuse: true; fuseTimeout: 2000"
          position="0 0 -1"
          geometry="primitive: ring; radiusInner: 0.025; radiusOuter: 0.03"
          material="color: #49FF00; shader: flat">
      </a-camera>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="-0.75 2 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="-0.25 2 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="0.25 2 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="0.75 2 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="-0.75 2.35 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="-0.25 2.35 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="0.25 2.35 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="0.75 2.35 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="-0.75 2.7 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="-0.25 2.7 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="0.25 2.7 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="alien"
      src="#alienModel"
      position ="0.75 2.7 -2"
      color="darkgreen"
      ></a-obj-model>

      <a-obj-model
      id="ship"
      src="#shipModel"
      position="0 0.75 -2"
      color = "red"></a-obj-model>

      <a-text
      id="fireButton"
      value="FIRE"
      geometry="primitive: plane, color: grey"
      color="purple"></a-text>


      <a-torus
      color="gray"
      position ="0 0.25 0"
      radius="2"
      radius-tubular="0.01"
      rotation="90 0 0"></a-torus>
    </a-scene>
  </body>
</html>
